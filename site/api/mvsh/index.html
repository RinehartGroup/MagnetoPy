
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Magnetometry Research in Python">
      
      
        <meta name="author" content="Rinehart Group">
      
      
      
        <link rel="prev" href="../dc_experiment/">
      
      
        <link rel="next" href="../zfcfc/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>MvsH - MagnetoPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#magnetopy.experiments.mvsh.MvsH" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MagnetoPy" class="md-header__button md-logo" aria-label="MagnetoPy" data-md-component="logo">
      
  <img src="../../assets/icons/72ppi/magpy_72ppi.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MagnetoPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MvsH
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../magnetometry/" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../file_formatting/" class="md-tabs__link">
      File Formatting
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../standard_calibration_library/" class="md-tabs__link">
      Standard Calibration Library
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MagnetoPy" class="md-nav__button md-logo" aria-label="MagnetoPy" data-md-component="logo">
      
  <img src="../../assets/icons/72ppi/magpy_72ppi.png" alt="logo">

    </a>
    MagnetoPy
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/reading_dat_file/" class="md-nav__link">
        Reading a .dat File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rwdat_file/" class="md-nav__link">
        Raw Data and the .rw.dat File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mvsh/" class="md-nav__link">
        The MvsH Experiment Class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/zfcfc/" class="md-nav__link">
        The ZFC and FC Experiment Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/magnetometry/" class="md-nav__link">
        Datasets in MagnetoPy: The Magnetometry Class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mvsh_analysis/" class="md-nav__link">
        A Simple M vs. H Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Magnetopy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Magnetopy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../magnetometry/" class="md-nav__link">
        Magnetometry
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          Data Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          Data Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dat_file/" class="md-nav__link">
        DatFile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generic_file/" class="md-nav__link">
        GenericFile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          Experiments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          Experiments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dc_experiment/" class="md-nav__link">
        DcExperiment
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          MvsH
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        MvsH
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH" class="md-nav__link">
    MvsH
  </a>
  
    <nav class="md-nav" aria-label="MvsH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.simplified_data" class="md-nav__link">
    simplified_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.scale_moment" class="md-nav__link">
    scale_moment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field" class="md-nav__link">
    correct_field()
  </a>
  
    <nav class="md-nav" aria-label="correct_field()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.select_segment" class="md-nav__link">
    select_segment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot_raw" class="md-nav__link">
    plot_raw()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot_raw_residual" class="md-nav__link">
    plot_raw_residual()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.as_dict" class="md-nav__link">
    as_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.get_all_in_file" class="md-nav__link">
    get_all_in_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection" class="md-nav__link">
    TrueFieldCorrection
  </a>
  
    <nav class="md-nav" aria-label="TrueFieldCorrection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_mvsh" class="md-nav__link">
    plot_mvsh()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_single_mvsh" class="md-nav__link">
    plot_single_mvsh()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_multiple_mvsh" class="md-nav__link">
    plot_multiple_mvsh()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../zfcfc/" class="md-nav__link">
        ZFC, FC, ZFCFC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../experiments_utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
          Analyses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          Analyses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        Analysis (Protocol)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simple_mvsh_analysis/" class="md-nav__link">
        SimpleMvsHAnalysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_5" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_5">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../parsing_utils/" class="md-nav__link">
        Parsing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_utils/" class="md-nav__link">
        Plotting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../file_formatting/" class="md-nav__link">
        File Formatting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../standard_calibration_library/" class="md-nav__link">
        Standard Calibration Library
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH" class="md-nav__link">
    MvsH
  </a>
  
    <nav class="md-nav" aria-label="MvsH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.simplified_data" class="md-nav__link">
    simplified_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.scale_moment" class="md-nav__link">
    scale_moment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field" class="md-nav__link">
    correct_field()
  </a>
  
    <nav class="md-nav" aria-label="correct_field()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.correct_field--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.select_segment" class="md-nav__link">
    select_segment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot" class="md-nav__link">
    plot()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot_raw" class="md-nav__link">
    plot_raw()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.plot_raw_residual" class="md-nav__link">
    plot_raw_residual()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.as_dict" class="md-nav__link">
    as_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.MvsH.get_all_in_file" class="md-nav__link">
    get_all_in_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection" class="md-nav__link">
    TrueFieldCorrection
  </a>
  
    <nav class="md-nav" aria-label="TrueFieldCorrection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--see-also" class="md-nav__link">
    See Also
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--notes" class="md-nav__link">
    Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.TrueFieldCorrection--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_mvsh" class="md-nav__link">
    plot_mvsh()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_single_mvsh" class="md-nav__link">
    plot_single_mvsh()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.experiments.mvsh.plot_multiple_mvsh" class="md-nav__link">
    plot_multiple_mvsh()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>MvsH</h1>

<div class="doc doc-object doc-class">



<h2 id="magnetopy.experiments.mvsh.MvsH" class="doc doc-heading">
          <code>magnetopy.experiments.mvsh.MvsH</code>


</h2>


  <div class="doc doc-contents first">

  
      <p>A single magnetization vs. field (hysteresis) experiment at a single temperature.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dat_file</code></td>
          <td>
                <code>str, Path, or DatFile</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The .dat file containing the data for the experiment.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>temperature</code></td>
          <td>
                <code>int or float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The temperature of the experiment in Kelvin. Requied if the .dat file contains
multiple uncommented experiments at different temperatures. If <code>None</code> and the
.dat file contains a single experiment, the temperature will be automatically
detected. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>parse_raw</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code> and there is a corresponding .rw.dat file, the raw data will be
parsed and added to the <code>data</code> attribute. Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments used for algorithmic separation of data at the requested
temperature. See <code>magnetopy.parsing_utils.label_clusters</code> for details.</p>
<ul>
<li>
<p>eps : float, optional</p>
</li>
<li>
<p>min_samples : int, optional</p>
</li>
<li>
<p>n_digits : int, optional</p>
</li>
</ul>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>origin_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the .dat file from which the data was parsed.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>temperature</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The temperature of the experiment in Kelvin.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>pandas.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data from the experiment. Columns are taken directly from the .dat file.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>field_correction_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the .dat file containing the Pd standard sequence used to correct
the magnetic field for flux trapping. If no field correction has been applied,
this will be an empty string.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>scaling</code></td>
          <td>
                <code>list of str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scaling applied to the data. If no scaling has been applied, this will be
an empty list. Possible values are: <code>"mass"</code>, <code>"molar"</code>, <code>"eicosane"</code>,
and <code>"diamagnetic_correction"</code>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>field_range</code></td>
          <td>
                <code>tuple of float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The minimum and maximum field values in the data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>self.<span title="self.TemperatureNotInDataError">TemperatureNotInDataError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the requested temperature is not in the data or the comments are not
formatted correctly and the temperature cannot be automatically detected.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>self.<span title="self.FieldCorrectionError">FieldCorrectionError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a field correction is applied but the Pd standard sequence does not have the
same number of data points as the MvsH sequence.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>self.<span title="self.SegmentError">SegmentError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the requested segment is not found in the data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">class</span> <span class="nc">MvsH</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A single magnetization vs. field (hysteresis) experiment at a single temperature.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    dat_file : str, Path, or DatFile</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        The .dat file containing the data for the experiment.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    temperature : int or float, optional</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        The temperature of the experiment in Kelvin. Requied if the .dat file contains</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        multiple uncommented experiments at different temperatures. If `None` and the</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        .dat file contains a single experiment, the temperature will be automatically</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        detected. Defaults to `None`.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    parse_raw : bool, optional</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        If `True` and there is a corresponding .rw.dat file, the raw data will be</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        parsed and added to the `data` attribute. Defaults to `False`.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    **kwargs : dict, optional</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        Keyword arguments used for algorithmic separation of data at the requested</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        temperature. See `magnetopy.parsing_utils.label_clusters` for details.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        - eps : float, optional</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        - min_samples : int, optional</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        - n_digits : int, optional</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    origin_file : str</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        The name of the .dat file from which the data was parsed.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    temperature : float</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        The temperature of the experiment in Kelvin.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    data : pandas.DataFrame</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        The data from the experiment. Columns are taken directly from the .dat file.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    field_correction_file : str</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        The name of the .dat file containing the Pd standard sequence used to correct</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        the magnetic field for flux trapping. If no field correction has been applied,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        this will be an empty string.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    scaling : list of str</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        The scaling applied to the data. If no scaling has been applied, this will be</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        an empty list. Possible values are: `&quot;mass&quot;`, `&quot;molar&quot;`, `&quot;eicosane&quot;`,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        and `&quot;diamagnetic_correction&quot;`.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    field_range : tuple of float</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        The minimum and maximum field values in the data.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    ------</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    self.TemperatureNotInDataError</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        If the requested temperature is not in the data or the comments are not</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        formatted correctly and the temperature cannot be automatically detected.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    self.FieldCorrectionError</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        If a field correction is applied but the Pd standard sequence does not have the</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        same number of data points as the MvsH sequence.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    self.SegmentError</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        If the requested segment is not found in the data.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">class</span> <span class="nc">TemperatureNotInDataError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">pass</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">class</span> <span class="nc">SegmentError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">pass</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">class</span> <span class="nc">FieldCorrectionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">pass</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">dat_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="n">DatFile</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">parse_raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">DatFile</span><span class="p">):</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">dat_file</span> <span class="o">=</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">dat_file</span><span class="p">),</span> <span class="n">parse_raw</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">origin_file</span> <span class="o">=</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">local_path</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="c1"># optional arguments used for algorithmic separation of</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="c1"># data at the requested temperature</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">n_digits</span> <span class="o">=</span> <span class="n">num_digits_after_decimal</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span> <span class="k">if</span> <span class="n">temperature</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;n_digits&quot;</span><span class="p">:</span> <span class="n">n_digits</span><span class="p">}</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">if</span> <span class="n">temperature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">temperature</span> <span class="o">=</span> <span class="n">_auto_detect_temperature</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="n">dat_file</span><span class="p">,</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;eps&quot;</span><span class="p">],</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;min_samples&quot;</span><span class="p">],</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;n_digits&quot;</span><span class="p">]</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">if</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_data_from_comments</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_data_auto</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="n">dat_file</span><span class="p">,</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;eps&quot;</span><span class="p">],</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;min_samples&quot;</span><span class="p">],</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;n_digits&quot;</span><span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">add_uncorrected_moment_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">field_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_field_range</span><span class="p">()</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_field_fluctuation_tolerance</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MvsH at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> K&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MvsH at </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> K&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">def</span> <span class="nf">_set_data_from_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat_file</span><span class="p">:</span> <span class="n">DatFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">start_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">end_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">for</span> <span class="n">comment_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data_idx</span><span class="p">,</span> <span class="n">comment_list</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="p">):</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="c1"># ignore other experiments</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="k">if</span> <span class="s2">&quot;mvsh&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">comment_list</span><span class="p">):</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="k">continue</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="c1"># one of the comments should be a number denoting the temperature</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="c1"># may also include a unit, e.g. &quot;300 K&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comment_list</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d+&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                    <span class="n">found_temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                    <span class="c1"># check to see if the unit is C otherwise assume K</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                    <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">comment</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                        <span class="n">found_temp</span> <span class="o">+=</span> <span class="mi">273</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                    <span class="k">if</span> <span class="n">found_temp</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                        <span class="n">start_idx</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                            <span class="n">data_idx</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                        <span class="p">)</span>  <span class="c1"># +1 to skip the line containing the comment</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                        <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                            <span class="nb">list</span><span class="p">(</span><span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">comment_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                            <span class="k">if</span> <span class="n">comment_idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                            <span class="k">else</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dat_file</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                        <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                        <span class="k">break</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">if</span> <span class="n">start_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="k">break</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">TemperatureNotInDataError</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="sa">f</span><span class="s2">&quot;Temperature </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> not in data in </span><span class="si">{</span><span class="n">dat_file</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="s2">&quot;Or the comments are not formatted correctly.&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">return</span> <span class="n">df</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span> <span class="nf">_set_data_auto</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">dat_file</span><span class="p">:</span> <span class="n">DatFile</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">file_data</span> <span class="o">=</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_clusters</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">],</span> <span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">temps</span> <span class="o">=</span> <span class="n">unique_values</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">],</span> <span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">TemperatureNotInDataError</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="sa">f</span><span class="s2">&quot;Temperature </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> not in data in </span><span class="si">{</span><span class="n">dat_file</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">temperature_index</span> <span class="o">=</span> <span class="n">temps</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">cluster</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">temperature_index</span><span class="p">]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">file_data</span><span class="p">[</span><span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cluster</span><span class="p">]</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">])</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">file_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="k">return</span> <span class="n">df</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="k">def</span> <span class="nf">simplified_data</span><span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="s2">&quot;loop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a simplified version of the data, removing unnecessary columns</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        and renaming the remaining columns to more convenient names.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            Return the selected segment. By default &quot;&quot;, which returns the full data.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        -------</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        pd.DataFrame</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            The simplified data. Contains the columns:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            - `&quot;time&quot;` in seconds</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            - `&quot;temperature&quot;` in Kelvin</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            - `&quot;field&quot;` in Oe</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            - `&quot;moment&quot;`</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            - `&quot;moment_err&quot;`</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            - `&quot;chi&quot;`</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            - `&quot;chi_err&quot;`</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            - `&quot;chi_t&quot;`</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            - `&quot;chi_t_err&quot;`</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            Where units are not specified, they are determined by the scaling applied to the</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            data (see `scaling` attribute).</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">full_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="k">if</span> <span class="n">segment</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Time Stamp (sec)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;uncorrected_moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;uncorrected_moment_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="k">return</span> <span class="n">df</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">def</span> <span class="nf">scale_moment</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">eicosane_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">molecular_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">diamagnetic_correction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds the following columns to the `DataFrame` in the `data` attribute:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        `&quot;moment&quot;`, `&quot;moment_err&quot;`, `&quot;chi&quot;`, `&quot;chi_err&quot;`, `&quot;chi_t&quot;`, and</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        `&quot;chi_t_err&quot;`. A record of what scaling was applied is added to the</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        `scaling` attribute.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        See `magnetopy.experiments.utils.scale_dc_data` for more information.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        mass : float, optional</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            mg of sample, by default 0.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        eicosane_mass : float, optional</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            mg of eicosane, by default 0.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        molecular_weight : float, optional</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            Molecular weight of the material in g/mol, by default 0.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        diamagnetic_correction : float, optional</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            Diamagnetic correction of the material in cm^3/mol, by default 0.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">scale_dc_data</span><span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">mass</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">eicosane_mass</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">molecular_weight</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">diamagnetic_correction</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">def</span> <span class="nf">correct_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_correction_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies a field correction to the data given data collected on the palladium</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        standard with the same sequence as the current `MvsH` object. Adds a column</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        called `&quot;true_field&quot;` to the `DataFrame` in the `data` attribute.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        See `magnetopy.cli.calibration_insall` for information on how to create a</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        calibration directory.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        field_correction_file : str | Path</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            The name of the .dat file containing the Pd standard sequence, or if a</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            configuration file containing calibration data is present, the name of the</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            sequence in the configuration file.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        ------</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        self.FieldCorrectionError</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            The true field calibration requires that the sequences of both the</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            M vs. H experiment and the calibration experiment be exactly the same. This</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            function only checks that they are the same length, and if they are not,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            raises this error.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        Notes</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        -----</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        As described in the Quantum Design application note[1], the magnetic field</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        reported by the magnetometer is determined by current from the magnet power</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        supply and not by direct measurement. Flux trapping in the magnet can cause</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        the reported field to be different from the actual field. While always present,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        it is most obvious in hysteresis curves of soft, non-hysteretic materials. In</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        some cases the forward and reverse scans can have negative and postive</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        coercivities, respectively, which is not physically possible.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        The true field correction remedies this by using a Pd standard to determine the</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        actual field applied to the sample. Assuming the calibration and sample</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        sequences are the same, it is assumed that the flux trapping is the same for</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        both sequences, and the calculated field from the measurement on the Pd</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        standard is applied to the sample data.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        References</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        [1] [Correcting for the Absolute Field Error using the Pd Standard](https://qdusa.com/siteDocs/appNotes/1500-021.pdf)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">pd_mvsh</span> <span class="o">=</span> <span class="n">TrueFieldCorrection</span><span class="p">(</span><span class="n">field_correction_file</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd_mvsh</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">FieldCorrectionError</span><span class="p">(</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="s2">&quot;The given Pd standard sequence does not have the same number of data &quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="s2">&quot;points as the MvsH sequence.&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="p">)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span> <span class="o">=</span> <span class="n">pd_mvsh</span><span class="o">.</span><span class="n">origin_file</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_mvsh</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">field_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_field_range</span><span class="p">()</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">def</span> <span class="nf">_determine_field_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">simplified_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simplified_data</span><span class="p">()</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="k">return</span> <span class="n">simplified_data</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">simplified_data</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">def</span> <span class="nf">virgin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="s2">&quot;virgin&quot;</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="s2">&quot;forward&quot;</span><span class="p">)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="s2">&quot;reverse&quot;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="s2">&quot;loop&quot;</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="k">def</span> <span class="nf">select_segment</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="s2">&quot;loop&quot;</span><span class="p">]</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the requested segment of the data, if it exists.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            The segment of the M vs. H data to return. &quot;loop&quot; refers to the combination</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            of the forward and reverse scans.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        -------</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        pd.DataFrame</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            The requested segment of the data.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        ------</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        self.SegmentError</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            If the requested segment is not found in the data.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">segment_starts</span> <span class="o">=</span> <span class="n">find_sequence_starts</span><span class="p">(</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_fluctuation_tolerance</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">requested_segment</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="c1"># assume virgin -&gt; reverse -&gt; forward</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;virgin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                    <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                    <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="c1"># check to see if it&#39;s forward -&gt; reverse or reverse -&gt; forward</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="k">elif</span> <span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                <span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="p">):</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                    <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                        <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                    <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                    <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                        <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                    <span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                        <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                    <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                        <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                    <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="s2">&quot;Full loop requested but only one segment found&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;virgin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                        <span class="s2">&quot;Virgin scan requested but data does not start at zero field&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                    <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                    <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                        <span class="s2">&quot;Forward scan requested but start field is greater than end field.&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                    <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                    <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                        <span class="s2">&quot;Reverse scan requested but start field is less than end field.&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                    <span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="sa">f</span><span class="s2">&quot;Something went wrong. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span><span class="si">}</span><span class="s2"> segments found&quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="k">if</span> <span class="n">requested_segment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequence </span><span class="si">{</span><span class="n">segment</span><span class="si">}</span><span class="s2"> not found in data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">return</span> <span class="n">requested_segment</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">segment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the M vs. H data data.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        normalized : bool, optional</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            If `True`, the magnetization will be normalized to the maximum value, by</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            default False.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">            If a segment is given, only that segment will be plotted, by default &quot;&quot;.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        color : str | list[str], optional</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            The color of the plot, by default &quot;auto&quot;. If &quot;auto&quot;, the color will be black.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        label : str | list[str] | None, optional</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            The labels to assign the `MvsH` object in the axes legend, by default &quot;auto&quot;.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            If &quot;auto&quot;, the label will be the `temperature` of the `MvsH` object.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        title : str, optional</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">            The title of the plot, by default &quot;&quot;.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        **kwargs</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            Keyword arguments mostly meant to affect the plot style. See</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">            `magnetopy.experiments.plot_utils.handle_options` for details.</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        -------</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="k">return</span> <span class="n">plot_single_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">normalized</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">def</span> <span class="nf">plot_raw</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">scan</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="s2">&quot;up_raw&quot;</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="s2">&quot;down&quot;</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="s2">&quot;down_raw&quot;</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="s2">&quot;processed&quot;</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">center</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">colors</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">),</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the raw voltage data for the requested segment.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;}, optional</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            The segment of the M vs. H data to plot, by default &quot;forward&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        scan : Literal[&quot;up&quot;, &quot;up_raw&quot;, &quot;down&quot;, &quot;down_raw&quot;, &quot;procssed&quot;], optional</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">            Which data to plot. `&quot;up&quot;` and `&quot;down&quot;` will plot the processed directional</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">            scans (which have been adjusted for drift and shifted to center the waveform</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            around 0, but have not been fit), `&quot;up_raw&quot;` and `&quot;down_raw&quot;` will plot the raw</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            voltages as the come straight off the SQUID, and `&quot;processed&quot;` will plot the</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">            processed data (which is the result of fitting the up and down scans). `&quot;up&quot;` by</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">            default.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        center : Literal[&quot;free&quot;, &quot;fixed&quot;], optional</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            Only used if `scan` is `&quot;processed&quot;`; determines whether to plot the &quot;Free C</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">            Fitted&quot; or &quot;Fixed C Fitted&quot; data. `&quot;free&quot;` by default.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        colors : tuple[str, str], optional</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            The (start, end) colors for the color gradient. `&quot;purple&quot;` and `&quot;orange&quot;` by</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            default.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        label : bool, optional</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            Default `True`. Whether to put labels on the plot for the initial and final</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            scans.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        title : str, optional</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            The title of the plot. `&quot;&quot;` by default.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        -------</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="k">return</span> <span class="n">plot_raw</span><span class="p">(</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="k">def</span> <span class="nf">plot_raw_residual</span><span class="p">(</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">scan</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">center</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;free&quot;</span><span class="p">,</span> <span class="s2">&quot;fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="n">colors</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the residual of the raw voltage data for the requested segment.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;}, optional</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            The segment of the M vs. H data to plot, by default &quot;forward&quot;</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        scan : Literal[&quot;up&quot;, &quot;down&quot;], optional</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">            Which data to use in the residual calculation. `&quot;up&quot;` and `&quot;down&quot;` will use the</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            processed directional scans (which have been adjusted for drift and shifted to</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            center the waveform around 0, but have not been fit). `&quot;up&quot;` by default.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">        center : Literal[&quot;free&quot;, &quot;fixed&quot;], optional</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">            Only used if `scan` is `&quot;processed&quot;`; determines whether to plot the &quot;Free C</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">            Fitted&quot; or &quot;Fixed C Fitted&quot; data. `&quot;free&quot;` by default.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        colors : tuple[str, str], optional</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            The (start, end) colors for the color gradient. `&quot;purple&quot;` and `&quot;orange&quot;` by</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">            default.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        label : bool, optional</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">            Default `True`. Whether to put labels on the plot for the initial and final</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            scans.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">        title : str, optional</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            The title of the plot. `&quot;&quot;` by default.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        -------</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="k">return</span> <span class="n">plot_raw_residual</span><span class="p">(</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a dictionary representation of the `MvsH` object.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        -------</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        dict[str, Any]</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            Keys are: `&quot;origin_file&quot;`, `&quot;temperature&quot;`, `&quot;field_range&quot;`,</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            `&quot;field_correction_file&quot;`, and `&quot;scaling&quot;`.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="s2">&quot;_class_&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>            <span class="s2">&quot;origin_file&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_file</span><span class="p">,</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="s2">&quot;field_range&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_range</span><span class="p">,</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="s2">&quot;field_correction_file&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span><span class="p">,</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>            <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="p">,</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="p">}</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="k">def</span> <span class="nf">get_all_in_file</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">dat_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="n">DatFile</span><span class="p">,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">ndigits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">parse_raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">]:</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a .dat file that contains one or more M vs. H experiments, returns a</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        list of `MvsH` objects, one for each experiment.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        dat_file : str | Path | DatFile</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">            The .dat file containing the data for the experiment.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        eps : float, optional</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            See `magnetopy.parsing_utils.label_clusters` for details, by default 0.001</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        min_samples : int, optional</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">            See `magnetopy.parsing_utils.label_clusters` for details, by default 10</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        ndigits : int, optional</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">            See `magnetopy.parsing_utils.label_clusters` for details, by default 0</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        parse_raw : bool, optional</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            If `True` and there is a corresponding .rw.dat file, the raw data will be</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">            parsed and added to the `data` attribute. Defaults to `False`.</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        -------</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        list[MvsH]</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">            A list of `MvsH` objects, one for each experiment in the .dat file, sorted</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">            by increasing temperature.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">DatFile</span><span class="p">):</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="n">dat_file</span> <span class="o">=</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">dat_file</span><span class="p">),</span> <span class="n">parse_raw</span><span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">if</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_all_mvsh_in_commented_file</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>            <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_all_mvsh_in_uncommented_file</span><span class="p">(</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                <span class="n">dat_file</span><span class="p">,</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="n">eps</span><span class="p">,</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                <span class="n">min_samples</span><span class="p">,</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="n">ndigits</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="n">mvsh_objs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="k">return</span> <span class="n">mvsh_objs</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="k">def</span> <span class="nf">_get_all_mvsh_in_commented_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat_file</span><span class="p">:</span> <span class="n">DatFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">]:</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="k">for</span> <span class="n">comment_list</span> <span class="ow">in</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>            <span class="c1"># ignore other experiments</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="k">if</span> <span class="s2">&quot;mvsh&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">comment_list</span><span class="p">):</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>                <span class="k">continue</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="c1"># one of the comments should be a number denoting the temperature</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="c1"># may also include a unit, e.g. &quot;300 K&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>            <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comment_list</span><span class="p">:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\d+&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                    <span class="n">temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>                    <span class="c1"># check to see if the unit is C otherwise assume K</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                    <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">comment</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>                        <span class="n">temp</span> <span class="o">+=</span> <span class="mi">273</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>                    <span class="n">mvsh_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">return</span> <span class="n">mvsh_objs</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">def</span> <span class="nf">_get_all_mvsh_in_uncommented_file</span><span class="p">(</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">dat_file</span><span class="p">:</span> <span class="n">DatFile</span><span class="p">,</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">ndigits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">]:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">file_data</span> <span class="o">=</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">data</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_clusters</span><span class="p">(</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">],</span> <span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">temps</span> <span class="o">=</span> <span class="n">unique_values</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">],</span> <span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">mvsh_objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">))</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">return</span> <span class="n">mvsh_objs</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.simplified_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">simplified_data</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a simplified version of the data, removing unnecessary columns
and renaming the remaining columns to more convenient names.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;&#39;, &#39;virgin&#39;, &#39;forward&#39;, &#39;reverse&#39;, &#39;loop&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the selected segment. By default "", which returns the full data.</p>
            </div>
          </td>
          <td>
                <code>&#34;&#34;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The simplified data. Contains the columns:
- <code>"time"</code> in seconds
- <code>"temperature"</code> in Kelvin
- <code>"field"</code> in Oe
- <code>"moment"</code>
- <code>"moment_err"</code>
- <code>"chi"</code>
- <code>"chi_err"</code>
- <code>"chi_t"</code>
- <code>"chi_t_err"</code></p>
<p>Where units are not specified, they are determined by the scaling applied to the
data (see <code>scaling</code> attribute).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="k">def</span> <span class="nf">simplified_data</span><span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="s2">&quot;loop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a simplified version of the data, removing unnecessary columns</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    and renaming the remaining columns to more convenient names.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        Return the selected segment. By default &quot;&quot;, which returns the full data.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    -------</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    pd.DataFrame</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        The simplified data. Contains the columns:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        - `&quot;time&quot;` in seconds</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        - `&quot;temperature&quot;` in Kelvin</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        - `&quot;field&quot;` in Oe</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        - `&quot;moment&quot;`</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        - `&quot;moment_err&quot;`</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        - `&quot;chi&quot;`</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        - `&quot;chi_err&quot;`</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        - `&quot;chi_t&quot;`</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        - `&quot;chi_t_err&quot;`</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        Where units are not specified, they are determined by the scaling applied to the</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        data (see `scaling` attribute).</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">full_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span> <span class="k">if</span> <span class="n">segment</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Time Stamp (sec)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;uncorrected_moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="s2">&quot;uncorrected_moment_err&quot;</span><span class="p">]</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;moment_err&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_t_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;chi_err&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.scale_moment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">scale_moment</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">eicosane_mass</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">molecular_weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">diamagnetic_correction</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Adds the following columns to the <code>DataFrame</code> in the <code>data</code> attribute:
<code>"moment"</code>, <code>"moment_err"</code>, <code>"chi"</code>, <code>"chi_err"</code>, <code>"chi_t"</code>, and
<code>"chi_t_err"</code>. A record of what scaling was applied is added to the
<code>scaling</code> attribute.</p>
<p>See <code>magnetopy.experiments.utils.scale_dc_data</code> for more information.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mass</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mg of sample, by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>eicosane_mass</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mg of eicosane, by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>molecular_weight</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Molecular weight of the material in g/mol, by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>diamagnetic_correction</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Diamagnetic correction of the material in cm^3/mol, by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="k">def</span> <span class="nf">scale_moment</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">eicosane_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">molecular_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">diamagnetic_correction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds the following columns to the `DataFrame` in the `data` attribute:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    `&quot;moment&quot;`, `&quot;moment_err&quot;`, `&quot;chi&quot;`, `&quot;chi_err&quot;`, `&quot;chi_t&quot;`, and</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    `&quot;chi_t_err&quot;`. A record of what scaling was applied is added to the</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    `scaling` attribute.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    See `magnetopy.experiments.utils.scale_dc_data` for more information.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    mass : float, optional</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        mg of sample, by default 0.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    eicosane_mass : float, optional</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        mg of eicosane, by default 0.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    molecular_weight : float, optional</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        Molecular weight of the material in g/mol, by default 0.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    diamagnetic_correction : float, optional</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Diamagnetic correction of the material in cm^3/mol, by default 0.</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">scale_dc_data</span><span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">mass</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">eicosane_mass</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">molecular_weight</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">diamagnetic_correction</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.correct_field" class="doc doc-heading">
<code class="highlight language-python"><span class="n">correct_field</span><span class="p">(</span><span class="n">field_correction_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Applies a field correction to the data given data collected on the palladium
standard with the same sequence as the current <code>MvsH</code> object. Adds a column
called <code>"true_field"</code> to the <code>DataFrame</code> in the <code>data</code> attribute.</p>
<p>See <code>magnetopy.cli.calibration_insall</code> for information on how to create a
calibration directory.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>field_correction_file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the .dat file containing the Pd standard sequence, or if a
configuration file containing calibration data is present, the name of the
sequence in the configuration file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>self.<span title="self.FieldCorrectionError">FieldCorrectionError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The true field calibration requires that the sequences of both the
M vs. H experiment and the calibration experiment be exactly the same. This
function only checks that they are the same length, and if they are not,
raises this error.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <h5 id="magnetopy.experiments.mvsh.MvsH.correct_field--notes">Notes</h5>
<p>As described in the Quantum Design application note[1], the magnetic field
reported by the magnetometer is determined by current from the magnet power
supply and not by direct measurement. Flux trapping in the magnet can cause
the reported field to be different from the actual field. While always present,
it is most obvious in hysteresis curves of soft, non-hysteretic materials. In
some cases the forward and reverse scans can have negative and postive
coercivities, respectively, which is not physically possible.</p>
<p>The true field correction remedies this by using a Pd standard to determine the
actual field applied to the sample. Assuming the calibration and sample
sequences are the same, it is assumed that the flux trapping is the same for
both sequences, and the calculated field from the measurement on the Pd
standard is applied to the sample data.</p>
<h5 id="magnetopy.experiments.mvsh.MvsH.correct_field--references">References</h5>
<p>[1] <a href="https://qdusa.com/siteDocs/appNotes/1500-021.pdf">Correcting for the Absolute Field Error using the Pd Standard</a></p>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span> <span class="nf">correct_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_correction_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a field correction to the data given data collected on the palladium</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    standard with the same sequence as the current `MvsH` object. Adds a column</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    called `&quot;true_field&quot;` to the `DataFrame` in the `data` attribute.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    See `magnetopy.cli.calibration_insall` for information on how to create a</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    calibration directory.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    field_correction_file : str | Path</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        The name of the .dat file containing the Pd standard sequence, or if a</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        configuration file containing calibration data is present, the name of the</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        sequence in the configuration file.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    ------</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    self.FieldCorrectionError</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        The true field calibration requires that the sequences of both the</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        M vs. H experiment and the calibration experiment be exactly the same. This</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        function only checks that they are the same length, and if they are not,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        raises this error.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    -----</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    As described in the Quantum Design application note[1], the magnetic field</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    reported by the magnetometer is determined by current from the magnet power</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    supply and not by direct measurement. Flux trapping in the magnet can cause</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    the reported field to be different from the actual field. While always present,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    it is most obvious in hysteresis curves of soft, non-hysteretic materials. In</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    some cases the forward and reverse scans can have negative and postive</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    coercivities, respectively, which is not physically possible.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    The true field correction remedies this by using a Pd standard to determine the</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    actual field applied to the sample. Assuming the calibration and sample</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    sequences are the same, it is assumed that the flux trapping is the same for</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    both sequences, and the calculated field from the measurement on the Pd</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    standard is applied to the sample data.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    References</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    [1] [Correcting for the Absolute Field Error using the Pd Standard](https://qdusa.com/siteDocs/appNotes/1500-021.pdf)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">pd_mvsh</span> <span class="o">=</span> <span class="n">TrueFieldCorrection</span><span class="p">(</span><span class="n">field_correction_file</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd_mvsh</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">FieldCorrectionError</span><span class="p">(</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="s2">&quot;The given Pd standard sequence does not have the same number of data &quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="s2">&quot;points as the MvsH sequence.&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="p">)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span> <span class="o">=</span> <span class="n">pd_mvsh</span><span class="o">.</span><span class="n">origin_file</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_mvsh</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">field_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_field_range</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.select_segment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the requested segment of the data, if it exists.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;virgin&#39;, &#39;forward&#39;, &#39;reverse&#39;, &#39;loop&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The segment of the M vs. H data to return. "loop" refers to the combination
of the forward and reverse scans.</p>
            </div>
          </td>
          <td>
                <code>&#34;virgin&#34;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The requested segment of the data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>self.<span title="self.SegmentError">SegmentError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the requested segment is not found in the data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="k">def</span> <span class="nf">select_segment</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="s2">&quot;loop&quot;</span><span class="p">]</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the requested segment of the data, if it exists.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        The segment of the M vs. H data to return. &quot;loop&quot; refers to the combination</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        of the forward and reverse scans.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    -------</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    pd.DataFrame</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        The requested segment of the data.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    ------</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    self.SegmentError</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        If the requested segment is not found in the data.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">segment_starts</span> <span class="o">=</span> <span class="n">find_sequence_starts</span><span class="p">(</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_fluctuation_tolerance</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">requested_segment</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="c1"># assume virgin -&gt; reverse -&gt; forward</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;virgin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="c1"># check to see if it&#39;s forward -&gt; reverse or reverse -&gt; forward</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">elif</span> <span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="p">):</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                    <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                    <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="n">segment_starts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">segment_starts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">if</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;loop&quot;</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="s2">&quot;Full loop requested but only one segment found&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;virgin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="s2">&quot;Virgin scan requested but data does not start at zero field&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                    <span class="s2">&quot;Forward scan requested but start field is greater than end field.&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="k">elif</span> <span class="n">segment</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Magnetic Field (Oe)&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                    <span class="s2">&quot;Reverse scan requested but start field is less than end field.&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                <span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="n">requested_segment</span> <span class="o">=</span> <span class="n">df</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="sa">f</span><span class="s2">&quot;Something went wrong. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">segment_starts</span><span class="p">)</span><span class="si">}</span><span class="s2"> segments found&quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="k">if</span> <span class="n">requested_segment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">SegmentError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequence </span><span class="si">{</span><span class="n">segment</span><span class="si">}</span><span class="s2"> not found in data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="k">return</span> <span class="n">requested_segment</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plots the M vs. H data data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>normalized</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the magnetization will be normalized to the maximum value, by
default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a segment is given, only that segment will be plotted, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#34;&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str | list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The color of the plot, by default "auto". If "auto", the color will be black.</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td>
                <code>str | list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The labels to assign the <code>MvsH</code> object in the axes legend, by default "auto".
If "auto", the label will be the <code>temperature</code> of the <code>MvsH</code> object.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments mostly meant to affect the plot style. See
<code>magnetopy.experiments.plot_utils.handle_options</code> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">segment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the M vs. H data data.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    normalized : bool, optional</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        If `True`, the magnetization will be normalized to the maximum value, by</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        default False.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        If a segment is given, only that segment will be plotted, by default &quot;&quot;.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    color : str | list[str], optional</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        The color of the plot, by default &quot;auto&quot;. If &quot;auto&quot;, the color will be black.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    label : str | list[str] | None, optional</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        The labels to assign the `MvsH` object in the axes legend, by default &quot;auto&quot;.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        If &quot;auto&quot;, the label will be the `temperature` of the `MvsH` object.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        The title of the plot, by default &quot;&quot;.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    **kwargs</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        Keyword arguments mostly meant to affect the plot style. See</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        `magnetopy.experiments.plot_utils.handle_options` for details.</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    -------</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="k">return</span> <span class="n">plot_single_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">normalized</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.plot_raw" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_raw</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plots the raw voltage data for the requested segment.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;virgin&#39;, &#39;forward&#39;, &#39;reverse&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The segment of the M vs. H data to plot, by default "forward"</p>
            </div>
          </td>
          <td>
                <code>&#34;virgin&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>scan</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;up&#39;, &#39;up_raw&#39;, &#39;down&#39;, &#39;down_raw&#39;, &#39;procssed&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Which data to plot. <code>"up"</code> and <code>"down"</code> will plot the processed directional
scans (which have been adjusted for drift and shifted to center the waveform
around 0, but have not been fit), <code>"up_raw"</code> and <code>"down_raw"</code> will plot the raw
voltages as the come straight off the SQUID, and <code>"processed"</code> will plot the
processed data (which is the result of fitting the up and down scans). <code>"up"</code> by
default.</p>
            </div>
          </td>
          <td>
                <code>&#39;up&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>center</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;free&#39;, &#39;fixed&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only used if <code>scan</code> is <code>"processed"</code>; determines whether to plot the "Free C
Fitted" or "Fixed C Fitted" data. <code>"free"</code> by default.</p>
            </div>
          </td>
          <td>
                <code>&#39;free&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (start, end) colors for the color gradient. <code>"purple"</code> and <code>"orange"</code> by
default.</p>
            </div>
          </td>
          <td>
                <code>(&#39;purple&#39;, &#39;orange&#39;)</code>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default <code>True</code>. Whether to put labels on the plot for the initial and final
scans.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot. <code>""</code> by default.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="k">def</span> <span class="nf">plot_raw</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="n">scan</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="s2">&quot;up_raw&quot;</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="s2">&quot;down&quot;</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="s2">&quot;down_raw&quot;</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="s2">&quot;processed&quot;</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="n">colors</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">),</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the raw voltage data for the requested segment.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;}, optional</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        The segment of the M vs. H data to plot, by default &quot;forward&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    scan : Literal[&quot;up&quot;, &quot;up_raw&quot;, &quot;down&quot;, &quot;down_raw&quot;, &quot;procssed&quot;], optional</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        Which data to plot. `&quot;up&quot;` and `&quot;down&quot;` will plot the processed directional</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        scans (which have been adjusted for drift and shifted to center the waveform</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        around 0, but have not been fit), `&quot;up_raw&quot;` and `&quot;down_raw&quot;` will plot the raw</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        voltages as the come straight off the SQUID, and `&quot;processed&quot;` will plot the</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        processed data (which is the result of fitting the up and down scans). `&quot;up&quot;` by</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        default.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    center : Literal[&quot;free&quot;, &quot;fixed&quot;], optional</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        Only used if `scan` is `&quot;processed&quot;`; determines whether to plot the &quot;Free C</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        Fitted&quot; or &quot;Fixed C Fitted&quot; data. `&quot;free&quot;` by default.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    colors : tuple[str, str], optional</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        The (start, end) colors for the color gradient. `&quot;purple&quot;` and `&quot;orange&quot;` by</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        default.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    label : bool, optional</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        Default `True`. Whether to put labels on the plot for the initial and final</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        scans.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        The title of the plot. `&quot;&quot;` by default.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    -------</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="k">return</span> <span class="n">plot_raw</span><span class="p">(</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.plot_raw_residual" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_raw_residual</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">scan</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="s1">&#39;free&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Plots the residual of the raw voltage data for the requested segment.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;virgin&#39;, &#39;forward&#39;, &#39;reverse&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The segment of the M vs. H data to plot, by default "forward"</p>
            </div>
          </td>
          <td>
                <code>&#34;virgin&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>scan</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;up&#39;, &#39;down&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Which data to use in the residual calculation. <code>"up"</code> and <code>"down"</code> will use the
processed directional scans (which have been adjusted for drift and shifted to
center the waveform around 0, but have not been fit). <code>"up"</code> by default.</p>
            </div>
          </td>
          <td>
                <code>&#39;up&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>center</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;free&#39;, &#39;fixed&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only used if <code>scan</code> is <code>"processed"</code>; determines whether to plot the "Free C
Fitted" or "Fixed C Fitted" data. <code>"free"</code> by default.</p>
            </div>
          </td>
          <td>
                <code>&#39;free&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
                <code>tuple[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (start, end) colors for the color gradient. <code>"purple"</code> and <code>"orange"</code> by
default.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default <code>True</code>. Whether to put labels on the plot for the initial and final
scans.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot. <code>""</code> by default.</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="k">def</span> <span class="nf">plot_raw_residual</span><span class="p">(</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">scan</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">center</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;free&quot;</span><span class="p">,</span> <span class="s2">&quot;fixed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;free&quot;</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">colors</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the residual of the raw voltage data for the requested segment.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    segment : {&quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;}, optional</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        The segment of the M vs. H data to plot, by default &quot;forward&quot;</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    scan : Literal[&quot;up&quot;, &quot;down&quot;], optional</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        Which data to use in the residual calculation. `&quot;up&quot;` and `&quot;down&quot;` will use the</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        processed directional scans (which have been adjusted for drift and shifted to</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        center the waveform around 0, but have not been fit). `&quot;up&quot;` by default.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    center : Literal[&quot;free&quot;, &quot;fixed&quot;], optional</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        Only used if `scan` is `&quot;processed&quot;`; determines whether to plot the &quot;Free C</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Fitted&quot; or &quot;Fixed C Fitted&quot; data. `&quot;free&quot;` by default.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">    colors : tuple[str, str], optional</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">        The (start, end) colors for the color gradient. `&quot;purple&quot;` and `&quot;orange&quot;` by</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        default.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    label : bool, optional</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        Default `True`. Whether to put labels on the plot for the initial and final</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        scans.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        The title of the plot. `&quot;&quot;` by default.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    -------</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="k">return</span> <span class="n">plot_raw_residual</span><span class="p">(</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">select_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.as_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">as_dict</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a dictionary representation of the <code>MvsH</code> object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keys are: <code>"origin_file"</code>, <code>"temperature"</code>, <code>"field_range"</code>,
<code>"field_correction_file"</code>, and <code>"scaling"</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dictionary representation of the `MvsH` object.</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    -------</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    dict[str, Any]</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        Keys are: `&quot;origin_file&quot;`, `&quot;temperature&quot;`, `&quot;field_range&quot;`,</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        `&quot;field_correction_file&quot;`, and `&quot;scaling&quot;`.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="s2">&quot;_class_&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="s2">&quot;origin_file&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_file</span><span class="p">,</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="s2">&quot;field_range&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_range</span><span class="p">,</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="s2">&quot;field_correction_file&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_correction_file</span><span class="p">,</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaling</span><span class="p">,</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="magnetopy.experiments.mvsh.MvsH.get_all_in_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_all_in_file</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Given a .dat file that contains one or more M vs. H experiments, returns a
list of <code>MvsH</code> objects, one for each experiment.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dat_file</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span> | <a class="autorefs autorefs-internal" title="magnetopy.data_files.DatFile" href="../dat_file/#magnetopy.data_files.DatFile">DatFile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The .dat file containing the data for the experiment.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>See <code>magnetopy.parsing_utils.label_clusters</code> for details, by default 0.001</p>
            </div>
          </td>
          <td>
                <code>0.001</code>
          </td>
        </tr>
        <tr>
          <td><code>min_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>See <code>magnetopy.parsing_utils.label_clusters</code> for details, by default 10</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>ndigits</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>See <code>magnetopy.parsing_utils.label_clusters</code> for details, by default 0</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>parse_raw</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code> and there is a corresponding .rw.dat file, the raw data will be
parsed and added to the <code>data</code> attribute. Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of <code>MvsH</code> objects, one for each experiment in the .dat file, sorted
by increasing temperature.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="k">def</span> <span class="nf">get_all_in_file</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="n">dat_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="n">DatFile</span><span class="p">,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="n">ndigits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">parse_raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">]:</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a .dat file that contains one or more M vs. H experiments, returns a</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    list of `MvsH` objects, one for each experiment.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    dat_file : str | Path | DatFile</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        The .dat file containing the data for the experiment.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">    eps : float, optional</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        See `magnetopy.parsing_utils.label_clusters` for details, by default 0.001</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    min_samples : int, optional</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        See `magnetopy.parsing_utils.label_clusters` for details, by default 10</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    ndigits : int, optional</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">        See `magnetopy.parsing_utils.label_clusters` for details, by default 0</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    parse_raw : bool, optional</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        If `True` and there is a corresponding .rw.dat file, the raw data will be</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">        parsed and added to the `data` attribute. Defaults to `False`.</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">    -------</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    list[MvsH]</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        A list of `MvsH` objects, one for each experiment in the .dat file, sorted</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        by increasing temperature.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">DatFile</span><span class="p">):</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="n">dat_file</span> <span class="o">=</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">dat_file</span><span class="p">),</span> <span class="n">parse_raw</span><span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="k">if</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">comments</span><span class="p">:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_all_mvsh_in_commented_file</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="n">mvsh_objs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_all_mvsh_in_uncommented_file</span><span class="p">(</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="n">dat_file</span><span class="p">,</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="n">eps</span><span class="p">,</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="n">min_samples</span><span class="p">,</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="n">ndigits</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>    <span class="n">mvsh_objs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="k">return</span> <span class="n">mvsh_objs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="magnetopy.experiments.mvsh.TrueFieldCorrection" class="doc doc-heading">
          <code>magnetopy.experiments.mvsh.TrueFieldCorrection</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a></code></p>

  
      <p>A special <code>MvsH</code> class for handling the palladium standard calibration data
used to correct the magnetic field for flux trapping. Unlikely to be used directly
by the user, and instead will be called from the <code>correct_field</code> method of the
<code>MvsH</code> class.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sequence</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This could be a path to a .dat file containing the Pd standard sequence, or if
a configuration file containing calibration data is present, the name of the
sequence in the configuration file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <h4 id="magnetopy.experiments.mvsh.TrueFieldCorrection--see-also">See Also</h4>
<p>magnetopy.cli.calibration_install</p>
<h4 id="magnetopy.experiments.mvsh.TrueFieldCorrection--notes">Notes</h4>
<p>As described in the Quantum Design application note[1], the magnetic field
reported by the magnetometer is determined by current from the magnet power
supply and not by direct measurement. Flux trapping in the magnet can cause
the reported field to be different from the actual field. While always present,
it is most obvious in hysteresis curves of soft, non-hysteretic materials. In
some cases the forward and reverse scans can have negative and postive
coercivities, respectively, which is not physically possible.</p>
<p>The true field correction remedies this by using a Pd standard to determine the
actual field applied to the sample. Provided the calibration and sample
sequences are the same, it is assumed that the flux trapping is the same for
both sequences, and the calculated field from the measurement on the Pd
standard is applied to the sample data.</p>
<h4 id="magnetopy.experiments.mvsh.TrueFieldCorrection--references">References</h4>
<p>[1] <a href="https://qdusa.com/siteDocs/appNotes/1500-021.pdf">Correcting for the Absolute Field Error using the Pd Standard</a></p>

            <details class="quote">
              <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="k">class</span> <span class="nc">TrueFieldCorrection</span><span class="p">(</span><span class="n">MvsH</span><span class="p">):</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A special `MvsH` class for handling the palladium standard calibration data</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    used to correct the magnetic field for flux trapping. Unlikely to be used directly</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">    by the user, and instead will be called from the `correct_field` method of the</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">    `MvsH` class.</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">    sequence : str | Path</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">        This could be a path to a .dat file containing the Pd standard sequence, or if</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        a configuration file containing calibration data is present, the name of the</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">        sequence in the configuration file.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">    See Also</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">    --------</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">    magnetopy.cli.calibration_install</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">    -----</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    As described in the Quantum Design application note[1], the magnetic field</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">    reported by the magnetometer is determined by current from the magnet power</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    supply and not by direct measurement. Flux trapping in the magnet can cause</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    the reported field to be different from the actual field. While always present,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    it is most obvious in hysteresis curves of soft, non-hysteretic materials. In</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">    some cases the forward and reverse scans can have negative and postive</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    coercivities, respectively, which is not physically possible.</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">    The true field correction remedies this by using a Pd standard to determine the</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    actual field applied to the sample. Provided the calibration and sample</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">    sequences are the same, it is assumed that the flux trapping is the same for</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">    both sequences, and the calculated field from the measurement on the Pd</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">    standard is applied to the sample data.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">    References</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    [1] [Correcting for the Absolute Field Error using the Pd Standard](https://qdusa.com/siteDocs/appNotes/1500-021.pdf)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">):</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="n">dat_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_dat_file</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pd_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mass</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>  <span class="c1"># mass of the Pd standard in mg</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_true_field</span><span class="p">()</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="k">def</span> <span class="nf">_get_dat_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatFile</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="k">return</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="n">mp_cal</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.magnetopy/calibration&quot;</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.dat&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">mp_cal</span> <span class="o">/</span> <span class="s2">&quot;calibration_files&quot;</span> <span class="o">/</span> <span class="n">sequence</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="k">return</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">mp_cal</span> <span class="o">/</span> <span class="s2">&quot;calibration_files&quot;</span> <span class="o">/</span> <span class="n">sequence</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mp_cal</span> <span class="o">/</span> <span class="s2">&quot;calibration.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="n">cal_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="k">if</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">cal_json</span><span class="p">[</span><span class="s2">&quot;mvsh&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="n">seq_dat</span> <span class="o">=</span> <span class="n">cal_json</span><span class="p">[</span><span class="s2">&quot;mvsh&quot;</span><span class="p">][</span><span class="n">sequence</span><span class="p">]</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="k">return</span> <span class="n">DatFile</span><span class="p">(</span><span class="n">mp_cal</span> <span class="o">/</span> <span class="s2">&quot;calibration_files&quot;</span> <span class="o">/</span> <span class="n">seq_dat</span><span class="p">)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="sa">f</span><span class="s2">&quot;Could not find the requested sequence: </span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="s2">&quot;TrueFieldCorrection requires either the name of a sequence listed in &quot;</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mp_cal</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;calibration.json&#39;</span><span class="si">}</span><span class="s2">, the name of a .dat file in &quot;</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mp_cal</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;calibration_files&#39;</span><span class="si">}</span><span class="s2">, or the path to a .dat file.&quot;</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>    <span class="k">def</span> <span class="nf">_get_mass</span><span class="p">(</span><span class="n">dat_file</span><span class="p">:</span> <span class="n">DatFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">dat_file</span><span class="o">.</span><span class="n">header</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">category</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>            <span class="k">if</span> <span class="n">category</span> <span class="o">!=</span> <span class="s2">&quot;INFO&quot;</span><span class="p">:</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="k">continue</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>            <span class="n">info</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="k">if</span> <span class="n">info</span> <span class="o">==</span> <span class="s2">&quot;SAMPLE_MASS&quot;</span><span class="p">:</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not find the sample mass in the .dat file header.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="k">def</span> <span class="nf">_add_true_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="n">chi_g</span> <span class="o">=</span> <span class="mf">5.25e-6</span>  <span class="c1"># emu Oe / g</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;true_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;uncorrected_moment&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="n">chi_g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pd_mass</span> <span class="o">*</span> <span class="mf">1e-3</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.experiments.mvsh.plot_mvsh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">mvsh</span><span class="o">.</span><span class="n">plot_mvsh</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Plots either a single M vs. H experiment or several on the same axes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mvsh</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a> | list[<a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to plot given as a single or list of <code>MvsH</code> objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>normalized</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the magnetization will be normalized to the maximum value, by
default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;&#39;, &#39;virgin&#39;, &#39;forward&#39;, &#39;reverse&#39;, &#39;loop&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a segment is given, only that segment will be plotted, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#34;&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
                <code>str | list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of colors corresponding to the <code>MvsH</code> objects in <code>mvsh</code>, by default
"auto". If "auto" and <code>mvsh</code> is a single <code>MvsH</code> object, the color will be
black. If "auto" and <code>mvsh</code> is a list of <code>MvsH</code> objects with different
temperatures, the colors will be a linear gradient from blue to red. If
"auto" and <code>mvsh</code> is a list of <code>MvsH</code> objects with the same temperature, the
colors will be the default <code>matplotlib</code> colors.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>str | list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The labels to assign the <code>MvsH</code> objects in the axes legend, by default "auto".
If "auto", the labels will be the <code>temperature</code> of the <code>MvsH</code> objects.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments mostly meant to affect the plot style. See
<code>magnetopy.experiments.plot_utils.handle_options</code> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="k">def</span> <span class="nf">plot_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="n">mvsh</span><span class="p">:</span> <span class="n">MvsH</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">],</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="n">segment</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;virgin&quot;</span><span class="p">,</span> <span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="s2">&quot;reverse&quot;</span><span class="p">,</span> <span class="s2">&quot;loop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="n">colors</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>    <span class="n">labels</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots either a single M vs. H experiment or several on the same axes.</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">    mvsh : MvsH | list[MvsH]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        The data to plot given as a single or list of `MvsH` objects.</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">    normalized : bool, optional</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        If `True`, the magnetization will be normalized to the maximum value, by</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        default False.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        If a segment is given, only that segment will be plotted, by default &quot;&quot;.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    colors : str | list[str], optional</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        A list of colors corresponding to the `MvsH` objects in `mvsh`, by default</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        &quot;auto&quot;. If &quot;auto&quot; and `mvsh` is a single `MvsH` object, the color will be</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        black. If &quot;auto&quot; and `mvsh` is a list of `MvsH` objects with different</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        temperatures, the colors will be a linear gradient from blue to red. If</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        &quot;auto&quot; and `mvsh` is a list of `MvsH` objects with the same temperature, the</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        colors will be the default `matplotlib` colors.</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    labels : str | list[str] | None, optional</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        The labels to assign the `MvsH` objects in the axes legend, by default &quot;auto&quot;.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">        If &quot;auto&quot;, the labels will be the `temperature` of the `MvsH` objects.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        The title of the plot, by default &quot;&quot;.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">    **kwargs</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        Keyword arguments mostly meant to affect the plot style. See</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        `magnetopy.experiments.plot_utils.handle_options` for details.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">    -------</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">mvsh</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">mvsh</span> <span class="o">=</span> <span class="n">mvsh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="n">MvsH</span><span class="p">):</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>                <span class="s2">&quot;If plotting a single MvsH, `colors` and `labels` must be a single value&quot;</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="p">)</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">return</span> <span class="n">plot_single_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="n">mvsh</span><span class="o">=</span><span class="n">mvsh</span><span class="p">,</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>            <span class="n">normalized</span><span class="o">=</span><span class="n">normalized</span><span class="p">,</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="n">segment</span><span class="o">=</span><span class="n">segment</span><span class="p">,</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>            <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>        <span class="p">)</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="k">if</span> <span class="n">colors</span> <span class="o">!=</span> <span class="s2">&quot;auto&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="s2">&quot;If plotting multiple MvsH, `colors` must be a list or &#39;auto&#39;.&quot;</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="p">)</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">labels</span> <span class="o">!=</span> <span class="s2">&quot;auto&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="s2">&quot;If plotting multiple MvsH, `labels` must be a list or &#39;auto&#39; or `None`.&quot;</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="p">)</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="k">return</span> <span class="n">plot_multiple_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>        <span class="n">mvsh</span><span class="p">,</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="n">normalized</span><span class="o">=</span><span class="n">normalized</span><span class="p">,</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="n">segment</span><span class="o">=</span><span class="n">segment</span><span class="p">,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.experiments.mvsh.plot_single_mvsh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">mvsh</span><span class="o">.</span><span class="n">plot_single_mvsh</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Plots a single M vs. H experiment.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mvsh</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to plot given as a single <code>MvsH</code> object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>normalized</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the magnetization will be normalized to the maximum value, by
default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a segment is given, only that segment will be plotted, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#34;&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>color</code></td>
          <td>
                <code>str | list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The color of the plot, by default "auto". If "auto", the color will be black.</p>
            </div>
          </td>
          <td>
                <code>&#39;black&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td>
                <code>str | list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The labels to assign the <code>MvsH</code> object in the axes legend, by default "auto".
If "auto", the label will be the <code>temperature</code> of the <code>MvsH</code> object.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments mostly meant to affect the plot style. See
<code>magnetopy.experiments.plot_utils.handle_options</code> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="k">def</span> <span class="nf">plot_single_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>    <span class="n">mvsh</span><span class="p">:</span> <span class="n">MvsH</span><span class="p">,</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="n">segment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a single M vs. H experiment.</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">    mvsh : MvsH</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        The data to plot given as a single `MvsH` object.</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">    normalized : bool, optional</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        If `True`, the magnetization will be normalized to the maximum value, by</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        default False.</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        If a segment is given, only that segment will be plotted, by default &quot;&quot;.</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">    color : str | list[str], optional</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        The color of the plot, by default &quot;auto&quot;. If &quot;auto&quot;, the color will be black.</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">    label : str | list[str] | None, optional</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        The labels to assign the `MvsH` object in the axes legend, by default &quot;auto&quot;.</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">        If &quot;auto&quot;, the label will be the `temperature` of the `MvsH` object.</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a><span class="sd">        The title of the plot, by default &quot;&quot;.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">    **kwargs</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        Keyword arguments mostly meant to affect the plot style. See</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">        `magnetopy.experiments.plot_utils.handle_options` for details.</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">    -------</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="n">options</span> <span class="o">=</span> <span class="n">handle_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span> <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="k">else</span> <span class="n">color</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">mvsh</span><span class="o">.</span><span class="n">simplified_data</span><span class="p">(</span><span class="n">segment</span><span class="p">)[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">mvsh</span><span class="o">.</span><span class="n">simplified_data</span><span class="p">(</span><span class="n">segment</span><span class="p">)[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="n">normalized</span> <span class="k">else</span> <span class="n">y</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>        <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mvsh</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> K&quot;</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Field (T)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Magnetization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">get_ylabel</span><span class="p">(</span><span class="s2">&quot;moment&quot;</span><span class="p">,</span> <span class="n">mvsh</span><span class="o">.</span><span class="n">scaling</span><span class="p">)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>    <span class="n">handle_options</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>    <span class="n">force_aspect</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="p">)</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.experiments.mvsh.plot_multiple_mvsh" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">experiments</span><span class="o">.</span><span class="n">mvsh</span><span class="o">.</span><span class="n">plot_multiple_mvsh</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">segment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Plots several M vs. H experiment on the same axes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mvsh</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a> | list[<a class="autorefs autorefs-internal" title="magnetopy.experiments.mvsh.MvsH" href="#magnetopy.experiments.mvsh.MvsH">MvsH</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data to plot given as a list of <code>MvsH</code> objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>normalized</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, the magnetization will be normalized to the maximum value, by
default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>segment</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a segment is given, only that segment will be plotted, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#34;&#34;</code>
          </td>
        </tr>
        <tr>
          <td><code>colors</code></td>
          <td>
                <code>str | list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of colors corresponding to the <code>MvsH</code> objects in <code>mvsh</code>, by default
"auto". If "auto" and <code>mvsh</code> is a list of <code>MvsH</code> objects with different
temperatures, the colors will be a linear gradient from blue to red. If
"auto" and <code>mvsh</code> is a list of <code>MvsH</code> objects with the same temperature, the
colors will be the default <code>matplotlib</code> colors.</p>
            </div>
          </td>
          <td>
                <code>&#39;auto&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>str | list[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The labels to assign the <code>MvsH</code> objects in the axes legend, by default "auto".
If "auto", the labels will be the <code>temperature</code> of the <code>MvsH</code> objects.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The title of the plot, by default "".</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments mostly meant to affect the plot style. See
<code>magnetopy.experiments.plot_utils.handle_options</code> for details.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="matplotlib">plt</span>.<span title="matplotlib.Figure">Figure</span>, <span title="matplotlib">plt</span>.<span title="matplotlib.Axes">Axes</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy\experiments\mvsh.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="k">def</span> <span class="nf">plot_multiple_mvsh</span><span class="p">(</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>    <span class="n">mvsh</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MvsH</span><span class="p">],</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>    <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>    <span class="n">segment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="n">colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots several M vs. H experiment on the same axes.</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="sd">    mvsh : MvsH | list[MvsH]</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        The data to plot given as a list of `MvsH` objects.</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">    normalized : bool, optional</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        If `True`, the magnetization will be normalized to the maximum value, by</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        default False.</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    segment : {&quot;&quot;, &quot;virgin&quot;, &quot;forward&quot;, &quot;reverse&quot;, &quot;loop&quot;}, optional</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        If a segment is given, only that segment will be plotted, by default &quot;&quot;.</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">    colors : str | list[str], optional</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        A list of colors corresponding to the `MvsH` objects in `mvsh`, by default</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">        &quot;auto&quot;. If &quot;auto&quot; and `mvsh` is a list of `MvsH` objects with different</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">        temperatures, the colors will be a linear gradient from blue to red. If</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">        &quot;auto&quot; and `mvsh` is a list of `MvsH` objects with the same temperature, the</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">        colors will be the default `matplotlib` colors.</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">    labels : str | list[str] | None, optional</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">        The labels to assign the `MvsH` objects in the axes legend, by default &quot;auto&quot;.</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        If &quot;auto&quot;, the labels will be the `temperature` of the `MvsH` objects.</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">    title : str, optional</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        The title of the plot, by default &quot;&quot;.</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">    **kwargs</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">        Keyword arguments mostly meant to affect the plot style. See</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        `magnetopy.experiments.plot_utils.handle_options` for details.</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    -------</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    tuple[plt.Figure, plt.Axes]</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="n">options</span> <span class="o">=</span> <span class="n">handle_kwargs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="k">if</span> <span class="n">colors</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">default_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mvsh</span><span class="p">))</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="k">if</span> <span class="n">_check_if_variable_temperature</span><span class="p">(</span><span class="n">mvsh</span><span class="p">):</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>        <span class="n">mvsh</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>        <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_gradient</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">mvsh</span><span class="p">))</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2"> K&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mvsh</span><span class="p">]</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mvsh</span><span class="p">)</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mvsh</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">simplified_data</span><span class="p">(</span><span class="n">segment</span><span class="p">)[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10000</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">simplified_data</span><span class="p">(</span><span class="n">segment</span><span class="p">)[</span><span class="s2">&quot;moment&quot;</span><span class="p">]</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">if</span> <span class="n">normalized</span> <span class="k">else</span> <span class="n">y</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>        <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Field (T)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Magnetization&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">get_ylabel</span><span class="p">(</span><span class="s2">&quot;moment&quot;</span><span class="p">,</span> <span class="n">mvsh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scaling</span><span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="n">handle_options</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="n">force_aspect</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">],</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>        <span class="p">)</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.next_prev", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>
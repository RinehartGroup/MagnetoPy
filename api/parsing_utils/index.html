
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Magnetometry Research in Python">
      
      
        <meta name="author" content="Rinehart Group">
      
      
      
        <link rel="prev" href="../simple_mvsh_analysis/">
      
      
        <link rel="next" href="../plot_utils/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Parsing - MagnetoPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#magnetopy.parsing_utils.label_clusters" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MagnetoPy" class="md-header__button md-logo" aria-label="MagnetoPy" data-md-component="logo">
      
  <img src="../../assets/icons/72ppi/magpy_72ppi.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MagnetoPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Parsing
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../magnetometry/" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../file_formatting/" class="md-tabs__link">
      File Formatting
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../standard_calibration_library/" class="md-tabs__link">
      Standard Calibration Library
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MagnetoPy" class="md-nav__button md-logo" aria-label="MagnetoPy" data-md-component="logo">
      
  <img src="../../assets/icons/72ppi/magpy_72ppi.png" alt="logo">

    </a>
    MagnetoPy
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/reading_dat_file/" class="md-nav__link">
        Reading a .dat File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/rwdat_file/" class="md-nav__link">
        Raw Data and the .rw.dat File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mvsh/" class="md-nav__link">
        The MvsH Experiment Class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/zfcfc/" class="md-nav__link">
        The ZFC and FC Experiment Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/magnetometry/" class="md-nav__link">
        Datasets in MagnetoPy: The Magnetometry Class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mvsh_analysis/" class="md-nav__link">
        A Simple M vs. H Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Magnetopy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Magnetopy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../magnetometry/" class="md-nav__link">
        Magnetometry
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          Data Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          Data Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dat_file/" class="md-nav__link">
        DatFile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generic_file/" class="md-nav__link">
        GenericFile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          Experiments
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          Experiments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dc_experiment/" class="md-nav__link">
        DcExperiment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mvsh/" class="md-nav__link">
        MvsH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../zfcfc/" class="md-nav__link">
        ZFC, FC, ZFCFC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../experiments_utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
          Analyses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          Analyses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        Analysis (Protocol)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simple_mvsh_analysis/" class="md-nav__link">
        SimpleMvsHAnalysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_1_5">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Parsing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Parsing
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.label_clusters" class="md-nav__link">
    label_clusters()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.unique_values" class="md-nav__link">
    unique_values()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_outlier_indices" class="md-nav__link">
    find_outlier_indices()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_temp_turnaround_point" class="md-nav__link">
    find_temp_turnaround_point()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_sequence_starts" class="md-nav__link">
    find_sequence_starts()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_utils/" class="md-nav__link">
        Plotting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../file_formatting/" class="md-nav__link">
        File Formatting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../standard_calibration_library/" class="md-nav__link">
        Standard Calibration Library
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.label_clusters" class="md-nav__link">
    label_clusters()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.unique_values" class="md-nav__link">
    unique_values()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_outlier_indices" class="md-nav__link">
    find_outlier_indices()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_temp_turnaround_point" class="md-nav__link">
    find_temp_turnaround_point()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#magnetopy.parsing_utils.find_sequence_starts" class="md-nav__link">
    find_sequence_starts()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Parsing</h1>

<p>These functions are used within the various data file and experiment classes and it's unlikely you'll need them while performing data analysis using <code>magnetopy</code>. Future development of new classes for new types of data files or new experiments may find these useful, though.</p>



<div class="doc doc-object doc-function">



<h2 id="magnetopy.parsing_utils.label_clusters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">parsing_utils</span><span class="o">.</span><span class="n">label_clusters</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>For determining the nominal values of data in a series containing one or more
nominal values with some fluctuations. The data is first normalized using
<code>sklearn.preprocessing.StandardScaler()</code>, then clustered using
<code>sklearn.cluster.DBSCAN()</code>.</p>
<p>It is assumed that all data belongs to a cluster (i.e. there are no outliers). If
this is not the case, <code>eps</code> is increased by a factor of 10 and the clustering is
tried again.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>vals</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A series of data containing one or more nominal values with some fluctuations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Passed to <code>sklearn.cluster.DBSCAN()</code>. The maximum distance between two samples
for one to be considered as in the neighborhood of the other, by default 0.001.</p>
            </div>
          </td>
          <td>
                <code>0.001</code>
          </td>
        </tr>
        <tr>
          <td><code>min_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Passed to <code>sklearn.cluster.DBSCAN()</code>. The number of samples in a neighborhood
for a point to be considered as a core point, by default 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array of the same size as <code>vals</code> which contains the cluster labels for each
element in <code>vals</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy/parsing_utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">def</span> <span class="nf">label_clusters</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">vals</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;For determining the nominal values of data in a series containing one or more</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    nominal values with some fluctuations. The data is first normalized using</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    `sklearn.preprocessing.StandardScaler()`, then clustered using</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">    `sklearn.cluster.DBSCAN()`.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    It is assumed that all data belongs to a cluster (i.e. there are no outliers). If</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    this is not the case, `eps` is increased by a factor of 10 and the clustering is</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    tried again.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    vals : pd.Series</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        A series of data containing one or more nominal values with some fluctuations.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    eps : float, optional</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        Passed to `sklearn.cluster.DBSCAN()`. The maximum distance between two samples</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        for one to be considered as in the neighborhood of the other, by default 0.001.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    min_samples : int, optional</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        Passed to `sklearn.cluster.DBSCAN()`. The number of samples in a neighborhood</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        for a point to be considered as a core point, by default 10.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    -------</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        An array of the same size as `vals` which contains the cluster labels for each</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        element in `vals`.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">reshaped_vals</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">reshaped_normalized_vals</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">reshaped_vals</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="c1"># adjust eps based on the range of the normalized data</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">eps_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">reshaped_normalized_vals</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">dbscan</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps_scaled</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">dbscan</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">reshaped_normalized_vals</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="c1"># all values should be assigned to a cluster</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="c1"># if not, increase eps and try again</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">label_clusters</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">return</span> <span class="n">cluster_labels</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.parsing_utils.unique_values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">parsing_utils</span><span class="o">.</span><span class="n">unique_values</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Given a series of data containing one or more nominal values with some noise,
returns a list of the nominal values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A series of data containing one or more nominal values with some noise.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>eps</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Passed to <code>label_clusters()</code>. The maximum distance between two samples for one
to be considered as in the neighborhood of the other, by default 0.001.</p>
            </div>
          </td>
          <td>
                <code>0.001</code>
          </td>
        </tr>
        <tr>
          <td><code>min_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Passed to <code>label_clusters()</code>. The number of samples in a neighborhood for a
point to be considered as a core point, by default 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>ndigits</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of digits after the decimal point to round the nominal values to,
by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The nominal values in <code>x</code> with the noise removed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy/parsing_utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">def</span> <span class="nf">unique_values</span><span class="p">(</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a series of data containing one or more nominal values with some noise,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    returns a list of the nominal values.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    x : pd.Series</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        A series of data containing one or more nominal values with some noise.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    eps : float, optional</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        Passed to `label_clusters()`. The maximum distance between two samples for one</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        to be considered as in the neighborhood of the other, by default 0.001.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    min_samples : int, optional</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        Passed to `label_clusters()`. The number of samples in a neighborhood for a</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        point to be considered as a core point, by default 10.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    ndigits : int, optional</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        The number of digits after the decimal point to round the nominal values to,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        by default 0.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    -------</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    list[float]</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        The nominal values in `x` with the noise removed.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">label_clusters</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">unique_vals</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cluster_labels</span><span class="p">):</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="c1"># average the values in each cluster</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">unique_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">cluster_labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">unique_val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">unique_val</span><span class="p">,</span> <span class="n">ndigits</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">if</span> <span class="n">ndigits</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">unique_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unique_val</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">unique_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unique_val</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">return</span> <span class="n">unique_vals</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.parsing_utils.find_outlier_indices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">parsing_utils</span><span class="o">.</span><span class="n">find_outlier_indices</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Finds the indices of outliers in a series of data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A series of data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of standard deviations from the mean to consider a value an outlier,
by default 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The indices of the outliers in <code>x</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy/parsing_utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="k">def</span> <span class="nf">find_outlier_indices</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the indices of outliers in a series of data.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    x : pd.Series</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        A series of data.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    threshold : float, optional</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        The number of standard deviations from the mean to consider a value an outlier,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        by default 3.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    -------</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    list[int]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        The indices of the outliers in `x`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">z_scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">outliers</span> <span class="o">=</span> <span class="n">z_scores</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">threshold</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">outliers</span><span class="p">[</span><span class="n">outliers</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.parsing_utils.find_temp_turnaround_point" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">parsing_utils</span><span class="o">.</span><span class="n">find_temp_turnaround_point</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_endpoints_ignored</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Finds the index of the temperature turnaround point in a dataframe of
a ZFCFC experiment which includes a column "Temperature (K)". Can handle two cases
in which a single dataframe contains first a ZFC experiment, then a FC experiment:
- Case 1: ZFC temperature monotonically increases, then FC temperature
monotonically decreases.
- Case 2: ZFC temperature monotonically increases, the temperature is reset to a
lower value, then FC temperature monotonically increases.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dataframe of a ZFCFC experiment which includes a column "Temperature (K)".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_endpoints_ignored</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of endpoints to ignore when finding the turnaround point, by default
20. This is useful when dealing with data collecting by scanning temperature,
as there are often 20 or so points at the end of the scane where the
temperature is very slowly settling.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The index of the temperature turnaround point.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>magnetopy/parsing_utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="k">def</span> <span class="nf">find_temp_turnaround_point</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">num_endpoints_ignored</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the index of the temperature turnaround point in a dataframe of</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    a ZFCFC experiment which includes a column &quot;Temperature (K)&quot;. Can handle two cases</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    in which a single dataframe contains first a ZFC experiment, then a FC experiment:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    - Case 1: ZFC temperature monotonically increases, then FC temperature</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    monotonically decreases.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    - Case 2: ZFC temperature monotonically increases, the temperature is reset to a</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    lower value, then FC temperature monotonically increases.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    df : pd.DataFrame</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        A dataframe of a ZFCFC experiment which includes a column &quot;Temperature (K)&quot;.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    num_endpoints_ignored : int, optional</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        The number of endpoints to ignore when finding the turnaround point, by default</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        20. This is useful when dealing with data collecting by scanning temperature,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        as there are often 20 or so points at the end of the scane where the</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        temperature is very slowly settling.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    -------</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    int</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        The index of the temperature turnaround point.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">find_outlier_indices</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outlier_indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="c1"># Case 1: zfc temp increases, fc temp decreases</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">zero_point</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">num_endpoints_ignored</span><span class="p">:</span><span class="o">-</span><span class="n">num_endpoints_ignored</span><span class="p">]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">return</span> <span class="n">zero_point</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="c1"># Case 2: zfc temp increases, reset temp, fc temp increases</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span> <span class="n">outlier_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="magnetopy.parsing_utils.find_sequence_starts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magnetopy</span><span class="o">.</span><span class="n">parsing_utils</span><span class="o">.</span><span class="n">find_sequence_starts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">flucuation_tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents first">
  
      <p>Find the indices of the start of each sequence in a series of data,
where a sequences is defined as a series of numbers that constantly increase or decrease.
Changes below <code>fluctuation_tolerance</code> are ignored.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A series of data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>flucuation_tolerance</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Changes below this value are ignored, by default 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="go">&gt;&gt;&gt;x = pd.Series([0, 1, 2, 3, 4, 3, 2, 1])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&gt;&gt;&gt;_find_sequence_starts(x)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">[0, 5]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="go">&gt;&gt;&gt;y = pd.Series([0, 1, 2, 3, 0, 1, 2, 3])</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&gt;&gt;&gt;_find_sequence_starts(y)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">[0, 4]</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>magnetopy/parsing_utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="k">def</span> <span class="nf">find_sequence_starts</span><span class="p">(</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">flucuation_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the indices of the start of each sequence in a series of data,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    where a sequences is defined as a series of numbers that constantly increase or decrease.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Changes below `fluctuation_tolerance` are ignored.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    x : pd.Series</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        A series of data.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    flucuation_tolerance : float, optional</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        Changes below this value are ignored, by default 0.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    --------</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    &gt;&gt;&gt;x = pd.Series([0, 1, 2, 3, 4, 3, 2, 1])</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    &gt;&gt;&gt;_find_sequence_starts(x)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    [0, 5]</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &gt;&gt;&gt;y = pd.Series([0, 1, 2, 3, 0, 1, 2, 3])</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    &gt;&gt;&gt;_find_sequence_starts(y)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    [0, 4]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="n">flucuation_tolerance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;fluctuation_tolerance must be non-negative&quot;</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()})</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">start</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">start</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="p">]</span>  <span class="c1"># since the first value of diff is NaN</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="c1"># if there&#39;s a really small diff value with the opposite sign of diff values around it, it&#39;s probably a mistake</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">sequence_starts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">last2_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">last1_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">current_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">next1_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">next2_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">next3_dir</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="c1"># reached end of dataframe</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="k">break</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="c1"># below handles, for example, zfc from 5 to 300 K, drop temp to 5 K, fc from 5 to 300 K</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">current_dir</span> <span class="o">!=</span> <span class="n">last1_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">current_dir</span> <span class="o">!=</span> <span class="n">next1_dir</span><span class="p">):</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;diff&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">flucuation_tolerance</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="c1"># this is a fluctuation and should be ignored</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">last1_dir</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="n">current_dir</span> <span class="o">=</span> <span class="n">last1_dir</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="n">sequence_starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="c1"># below handles, for example, zfc from 5 to 300 K, fc from 300 to 5 K</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># assumes there won&#39;t be any fluctuations at the beginning of a sequence</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="p">(</span><span class="n">last2_dir</span> <span class="o">==</span> <span class="n">last1_dir</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">current_dir</span> <span class="o">!=</span> <span class="n">last1_dir</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">current_dir</span> <span class="o">==</span> <span class="n">next1_dir</span> <span class="o">==</span> <span class="n">next2_dir</span> <span class="o">==</span> <span class="n">next3_dir</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="p">):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">sequence_starts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">return</span> <span class="n">sequence_starts</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.next_prev", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>